function format(d) {
  return (
    '<div class="row d-flex align-items-center justify-content-center pb-3" style="max-height: 400px; overflow-y: scroll;"><div class="col-md-11"><div class="card content"><div class="card-header text-center fs-5">Product Information</div><div class="card-body table-responsive">' +
    '<table class="table table-sm table-borderless table-striped">' +
    "<thead>" +
    "<tr>" +
    "<th>Product Code</th>" +
    "<th>Description</th>" +
    "<th>Cases</th>" +
    "<th>Batch</th>" +
    "<th>Expiration</th>" +
    "</tr>" +
    "</thead>" +
    "<tbody>" +
    "<tr>" +
    "<td>136972</td>" +
    "<td>HO ORG UP MILK 2% 64OZ 6CT CA</td>" +
    "<td>80</td>" +
    "<td>2022.08.14</td>" +
    "<td>08/14/2022</td>" +
    "</tr>" +
    "<tr>" +
    "<td>136972</td>" +
    "<td>HO ORG UP MILK 2% 64OZ 6CT CA</td>" +
    "<td>80</td>" +
    "<td>2022.08.14</td>" +
    "<td>08/14/2022</td>" +
    "</tr>" +
    "<tr>" +
    "<td>136972</td>" +
    "<td>HO ORG UP MILK 2% 64OZ 6CT CA</td>" +
    "<td>80</td>" +
    "<td>2022.08.14</td>" +
    "<td>08/14/2022</td>" +
    "</tr>" +
    "<tr>" +
    "<td>136972</td>" +
    "<td>HO ORG UP MILK 2% 64OZ 6CT CA</td>" +
    "<td>80</td>" +
    "<td>2022.08.14</td>" +
    "<td>08/14/2022</td>" +
    "</tr>" +
    "<tr>" +
    "<td>136972</td>" +
    "<td>HO ORG UP MILK 2% 64OZ 6CT CA</td>" +
    "<td>80</td>" +
    "<td>2022.08.14</td>" +
    "<td>08/14/2022</td>" +
    "</tr>" +
    "<tr>" +
    "<td>136972</td>" +
    "<td>HO ORG UP MILK 2% 64OZ 6CT CA</td>" +
    "<td>80</td>" +
    "<td>2022.08.14</td>" +
    "<td>08/14/2022</td>" +
    "</tr>" +
    "<tr>" +
    "<td>136972</td>" +
    "<td>HO ORG UP MILK 2% 64OZ 6CT CA</td>" +
    "<td>80</td>" +
    "<td>2022.08.14</td>" +
    "<td>08/14/2022</td>" +
    "</tr>" +
    "<tr>" +
    "<td>136972</td>" +
    "<td>HO ORG UP MILK 2% 64OZ 6CT CA</td>" +
    "<td>80</td>" +
    "<td>2022.08.14</td>" +
    "<td>08/14/2022</td>" +
    "</tr>" +
    "<tr>" +
    "<td>136972</td>" +
    "<td>HO ORG UP MILK 2% 64OZ 6CT CA</td>" +
    "<td>80</td>" +
    "<td>2022.08.14</td>" +
    "<td>08/14/2022</td>" +
    "</tr>" +
    "<tr>" +
    "<td>136972</td>" +
    "<td>HO ORG UP MILK 2% 64OZ 6CT CA</td>" +
    "<td>80</td>" +
    "<td>2022.08.14</td>" +
    "<td>08/14/2022</td>" +
    "</tr>" +
    "<tr>" +
    "<td>136972</td>" +
    "<td>HO ORG UP MILK 2% 64OZ 6CT CA</td>" +
    "<td>80</td>" +
    "<td>2022.08.14</td>" +
    "<td>08/14/2022</td>" +
    "</tr>" +
    "<tr>" +
    "<td>136972</td>" +
    "<td>HO ORG UP MILK 2% 64OZ 6CT CA</td>" +
    "<td>80</td>" +
    "<td>2022.08.14</td>" +
    "<td>08/14/2022</td>" +
    "</tr>" +
    "<tr>" +
    "<td>136972</td>" +
    "<td>HO ORG UP MILK 2% 64OZ 6CT CA</td>" +
    "<td>80</td>" +
    "<td>2022.08.14</td>" +
    "<td>08/14/2022</td>" +
    "</tr>" +
    "<tr>" +
    "<td>136972</td>" +
    "<td>HO ORG UP MILK 2% 64OZ 6CT CA</td>" +
    "<td>80</td>" +
    "<td>2022.08.14</td>" +
    "<td>08/14/2022</td>" +
    "</tr>" +
    "<tr>" +
    "<td>136972</td>" +
    "<td>HO ORG UP MILK 2% 64OZ 6CT CA</td>" +
    "<td>80</td>" +
    "<td>2022.08.14</td>" +
    "<td>08/14/2022</td>" +
    "</tr>" +
    "<tr>" +
    "<td>136972</td>" +
    "<td>HO ORG UP MILK 2% 64OZ 6CT CA</td>" +
    "<td>80</td>" +
    "<td>2022.08.14</td>" +
    "<td>08/14/2022</td>" +
    "</tr>" +
    "<tr>" +
    "<td>136972</td>" +
    "<td>HO ORG UP MILK 2% 64OZ 6CT CA</td>" +
    "<td>80</td>" +
    "<td>2022.08.14</td>" +
    "<td>08/14/2022</td>" +
    "</tr>" +
    "<tr>" +
    "<td>136972</td>" +
    "<td>HO ORG UP MILK 2% 64OZ 6CT CA</td>" +
    "<td>80</td>" +
    "<td>2022.08.14</td>" +
    "<td>08/14/2022</td>" +
    "</tr>" +
    "<tr>" +
    "<td>136972</td>" +
    "<td>HO ORG UP MILK 2% 64OZ 6CT CA</td>" +
    "<td>80</td>" +
    "<td>2022.08.14</td>" +
    "<td>08/14/2022</td>" +
    "</tr>" +
    "<tr>" +
    "<td>136972</td>" +
    "<td>HO ORG UP MILK 2% 64OZ 6CT CA</td>" +
    "<td>80</td>" +
    "<td>2022.08.14</td>" +
    "<td>08/14/2022</td>" +
    "</tr>" +
    "<tr>" +
    "<td>136972</td>" +
    "<td>HO ORG UP MILK 2% 64OZ 6CT CA</td>" +
    "<td>80</td>" +
    "<td>2022.08.14</td>" +
    "<td>08/14/2022</td>" +
    "</tr>" +
    "<tr>" +
    "<td>136972</td>" +
    "<td>HO ORG UP MILK 2% 64OZ 6CT CA</td>" +
    "<td>80</td>" +
    "<td>2022.08.14</td>" +
    "<td>08/14/2022</td>" +
    "</tr>" +
    "<tr>" +
    "<td>136972</td>" +
    "<td>HO ORG UP MILK 2% 64OZ 6CT CA</td>" +
    "<td>80</td>" +
    "<td>2022.08.14</td>" +
    "<td>08/14/2022</td>" +
    "</tr>" +
    "<tr>" +
    "<td>136972</td>" +
    "<td>HO ORG UP MILK 2% 64OZ 6CT CA</td>" +
    "<td>80</td>" +
    "<td>2022.08.14</td>" +
    "<td>08/14/2022</td>" +
    "</tr>" +
    "<tr>" +
    "<td>10022066</td>" +
    "<td>CHEP Pallet</td>" +
    "<td>24</td>" +
    "<td></td>" +
    "<td></td>" +
    "</tr>" +
    "</tbody>" +
    "</table></div></div></div></div>"
  );
}

function format2(d) {
  return (
    '<div class="row d-flex align-items-center justify-content-center pb-3"><div class="col-md-11"><div class="card content"><div class="card-header text-center fs-5">Daily Activity Log - <small>2/22/2023</small><span class="card-header-options"></span></div><div class="card-body table-responsive">' +
    '<table class="table table-sm table-borderless table-striped">' +
    "<thead>" +
    "<tr>" +
    "<th>Location</th>" +
    "<th>Arrival Time</th>" +
    "<th>Instructions Received</th>" +
    "<th>Instructions Accepted</th>" +
    "<th>Departure Time</th>" +
    "<th>Reason</th>" +
    "<th>Trailer</th>" +
    "<th>Total Time</th>" +
    "</tr>" +
    "</thead>" +
    "<tbody>" +
    "<tr>" +
    "<td>Danone Plant</td>" +
    "<td>1:30 PM</td>" +
    "<td>1:57 PM</td>" +
    "<td>1:59 PM</td>" +
    "<td>2:10 PM</td>" +
    "<td>Pre-Trip / Waiting</td>" +
    "<td>-</td>" +
    "<td>40 mins</td>" +
    "</tr>" +
    "<tr>" +
    "<td>Americold ONT</td>" +
    "<td>3:03 PM</td>" +
    "<td>3:21 PM</td>" +
    "<td>3:29 PM</td>" +
    "<td>3:46 PM</td>" +
    '<td><a class="text-mron" href="/projects/logistics-management/shipments/details?id=5013841193" target="_blank">5013841193</a></td>' +
    "<td>50191</td>" +
    "<td>43 mins</td>" +
    "</tr>" +
    "<tr>" +
    "<td>Danone Plant</td>" +
    "<td>4:22 PM</td>" +
    "<td>6:17 PM</td>" +
    "<td>6:20 PM</td>" +
    "<td>7:45 PM</td>" +
    " <td>Returned Empty Trailer</td>" +
    "<td>5097</td>" +
    " <td>3 hrs 23 mins</td>" +
    "</tr>" +
    "<tr>" +
    "<td>N/A</td>" +
    "<td>7:45 PM</td>" +
    "<td>-</td>" +
    "<td>-</td>" +
    "<td>8:16 PM</td>" +
    " <td>Lunch Break</td>" +
    "<td>-</td>" +
    " <td>31 mins</td>" +
    "</tr>" +
    "<tr>" +
    "<td>Danone Plant</td>" +
    "<td>8:16 PM</td>" +
    "<td>10:11 PM</td>" +
    "<td>10:13 PM</td>" +
    "<td>10:27 PM</td>" +
    " <td>Waiting</td>" +
    "<td>-</td>" +
    " <td>2 hrs 9 mins</td>" +
    "</tr>" +
    "<tr>" +
    "<td>Americold COI</td>" +
    "<td>10:40 PM</td>" +
    "<td>11:26 PM</td>" +
    "<td>11:26 PM</td>" +
    "<td>11:45 PM</td>" +
    ' <td><a class="text-mron" href="/projects/logistics-management/shipments/details?id=5012802619" target="_blank">5012802619</a></td>' +
    "<td>5001</td>" +
    " <td>1 hr 5 mins</td>" +
    "</tr>" +
    "<tr>" +
    "<td>Danone Plant</td>" +
    "<td>12:00 AM</td>" +
    "<td>-</td>" +
    "<td>-</td>" +
    "<td>1:30 AM</td>" +
    " <td>Returned Bobtail</td>" +
    "<td>-</td>" +
    " <td>1 hrs 30 mins</td>" +
    "</tr>" +
    "<tr>" +
    "</tbody>" +
    "</table></div></div></div></div>"
  );
}

function format3(d) {
  return (
    '<div class="row d-flex align-items-center justify-content-center pb-3"><div class="col-md-11"><div class="card content"><div class="card-header text-center fs-5">Daily Activity Log - <small>' +
    d.date +
    '</small><span class="card-header-options"></span></div><div class="card-body table-responsive">' +
    '<table class="table table-sm table-borderless table-striped">' +
    "<thead>" +
    "<tr>" +
    '<th class="text-center">Location</th>' +
    '<th class="text-center">Arrival Time</th>' +
    '<th class="text-center">Instruction Time</th>' +
    '<th class="text-center">Departure Time</th>' +
    '<th class="text-center">Reason</th>' +
    '<th class="text-center">Total Time</th>' +
    "</tr>" +
    "</thead>" +
    "<tbody>" +
    "<tr>" +
    '<td class="text-center">Danone Plant</td>' +
    '<td class="text-center">1:30 PM</td>' +
    '<td class="text-center">1:57 PM</td>' +
    '<td class="text-center">2:10 PM</td>' +
    '<td class="text-center">Pre-Trip / Waiting</td>' +
    '<td class="text-center">40 mins</td>' +
    "</tr>" +
    "<tr>" +
    '<td class="text-center">Americold ONT</td>' +
    '<td class="text-center">3:03 PM</td>' +
    '<td class="text-center">3:21 PM</td>' +
    '<td class="text-center">3:46 PM</td>' +
    '<td class="text-center"><a class="text-mron" href="/projects/logistics-management/shipments/details?id=5013841193" target="_blank">5013841193</a></td>' +
    '<td class="text-center">43 mins</td>' +
    "</tr>" +
    "<tr>" +
    '<td class="text-center">Danone Plant</td>' +
    '<td class="text-center">4:22 PM</td>' +
    '<td class="text-center">6:20 PM</td>' +
    '<td class="text-center">7:45 PM</td>' +
    ' <td class="text-center">Returned Empty Trailer</td>' +
    ' <td class="text-center">3 hrs 23 mins</td>' +
    "</tr>" +
    "<tr>" +
    '<td class="text-center">N/A</td>' +
    '<td class="text-center">7:45 PM</td>' +
    '<td class="text-center">-</td>' +
    '<td class="text-center">8:16 PM</td>' +
    ' <td class="text-center">Lunch Break</td>' +
    ' <td class="text-center">31 mins</td>' +
    "</tr>" +
    "<tr>" +
    '<td class="text-center">Danone Plant</td>' +
    '<td class="text-center">8:16 PM</td>' +
    '<td class="text-center">10:11 PM</td>' +
    '<td class="text-center">10:27 PM</td>' +
    ' <td class="text-center">Waiting</td>' +
    ' <td class="text-center">2 hrs 9 mins</td>' +
    "</tr>" +
    "<tr>" +
    '<td class="text-center">Americold COI</td>' +
    '<td class="text-center">10:40 PM</td>' +
    '<td class="text-center">11:26 PM</td>' +
    '<td class="text-center">11:45 PM</td>' +
    ' <td class="text-center"><a class="text-mron" href="/projects/logistics-management/shipments/details?id=5012802619" target="_blank">5012802619</a></td>' +
    ' <td class="text-center">1 hr 5 mins</td>' +
    "</tr>" +
    "<tr>" +
    '<td class="text-center">Danone Plant</td>' +
    '<td class="text-center">12:00 AM</td>' +
    '<td class="text-center">-</td>' +
    '<td class="text-center">1:30 AM</td>' +
    ' <td class="text-center">Returned Bobtail</td>' +
    ' <td class="text-center">1 hrs 30 mins</td>' +
    "</tr>" +
    "<tr>" +
    "</tbody>" +
    "</table></div></div></div></div>"
  );
}

var dataIndex = 0;

$(document).ready(function () {
  $.fn.dataTable.moment("l");

  var allDriverTable = $("#allDriverTable").DataTable({
    responsive: true,
    paging: false,
    searching: false,
    info: false,
    ajax: fileLocation + "../../../src/requests/driver.php?action=list",
    columns: [{ data: "name" }],
    columnDefs: [
      {
        targets: 0,
        createdCell: function (td, cellData, rowData, row, col) {
          $(td).attr("data-bs-toggle", "tooltip");
          $(td).attr("data-bs-placement", "top");
          $(td).attr("data-bs-html", "true");
          $(td).attr("title", "Toggle Daily Activity Log");
        },
      },
    ],
    drawCallback: function (data) {
      initializePopovers();
    },
  });
  var activeDriverTable = $("#activeDriverTable").DataTable({
    responsive: true,
    paging: false,
    searching: false,
    info: false,
    ajax: fileLocation + "../../../src/requests/driver.php?action=activeList",
    columns: [
      {
        className: "dt-control",
        orderable: false,
        data: null,
        defaultContent: "",
      },
      { data: "name" },
      { data: "startTime" },
      { data: "location" },
      { data: "shipment" },
      { data: "status" },
      { data: "lastUpdate" },
    ],
    columnDefs: [
      {
        targets: 0,
        createdCell: function (td, cellData, rowData, row, col) {
          $(td).attr("data-bs-toggle", "tooltip");
          $(td).attr("data-bs-placement", "top");
          $(td).attr("data-bs-html", "true");
          $(td).attr("title", "Toggle Daily Activity Log");
        },
      },
    ],
    order: [[2, "asc"]],
    drawCallback: function (data) {
      initializePopovers();
    },
  });

  var availableDriversTable = $("#availableDriversTable").DataTable({
    responsive: true,
    paging: false,
    searching: false,
    info: false,
    ordering: false,
    ajax: fileLocation + "../../src/requests/driver.php?action=availableList",
    columns: [
      {
        className: "",
        orderable: false,
        data: null,
        defaultContent: "",
        width: "1%",
        render: function (data, type, row, meta) {
          var content = row.carrierId === "1" ? "N" : "C";
          var color = content === "N" ? "#00ADEF" : "#B60002";
          return (
            '<span class="dt-nrt" data-terminal="' +
            content +
            '" style="--text-color: ' +
            color +
            ';"></span>'
          );
        },
      },
      { data: "name" },
      { data: "status" },
      { data: "lastUpdate", className: "text-center" },
      { data: "startTime", className: "text-center" },
      { data: "action", className: "text-center" },
    ],
    columnDefs: [
      {
        targets: 0,
        createdCell: function (td, cellData, rowData, row, col) {
          $(td).attr("data-bs-toggle", "tooltip");
          $(td).attr("data-bs-placement", "top");
          $(td).attr("data-bs-html", "true");

          var location = rowData.startingLocation;
          if (location === "Cordova") {
            $(td).attr("title", rowData.startingLocation + " Driver");
          } else if (location === "Northern") {
            $(td).attr("title", "Northern Yard");
          } else {
            $(td).attr("title", "Danone Plant");
          }
        },
      },
    ],
    language: {
      emptyTable: "<em>There are currently no available drivers</em>",
    },
    drawCallback: function (data) {
      initializePopovers();
    },
  });

  var flaggedActivityLogsTable = $("#flaggedActivityLogsTable").DataTable({
    ajax: fileLocation + "../../../src/requests/logs.php?action=get-all-flagged",
    responsive: true,
    columns: [
      { data: "date" },
      { data: "driver" },
      { data: "facility" },
      { data: "reason" },
      { data: "arrivalTime" },
      { data: "instructionsReceived" },
      { data: "instructionsAccepted" },
      { data: "departureTime" },
      { data: "yardMoves" },
    ],
    columnDefs: [
      {
        target: [4],
        render: function (data, type, row, meta) {
          return data === null ? "- - - - - -" : moment(data).format("LT");
        },
        createdCell: function (td, cellData, rowData, row, col) {
          var arrivalTime = moment(rowData.arrivalTime);
          var departureTime = moment(rowData.depatureTime);
          var instructionsReceived = moment(rowData.instructionsReceived);
          var instructionsAccepted = moment(rowData.instructionsAccepted);

          if (
            arrivalTime.isValid() &&
            departureTime.isValid() &&
            !instructionsReceived.isValid() &&
            !instructionsAccepted.isValid()
          ) {
            var difference = moment.duration(departureTime.diff(arrivalTime));
            if (difference > 60000 * 30) {
              // 30 minutes
              $(td).css("background-color", "rgba(255, 0, 0, 0.2)");
            }
          }
        },
      },
      {
        // Instructions Received
        target: [5],
        render: function (data, type, row, meta) {
          return data === null ? "- - - - - -" : moment(data).format("LT");
        },
        createdCell: function (td, cellData, rowData, row, col) {
          var instructionsReceived = moment(rowData.instructionsReceived);
          var instructionsAccepted = moment(rowData.instructionsAccepted);

          if (
            instructionsAccepted.isValid() &&
            instructionsReceived.isValid()
          ) {
            var difference = moment.duration(
              instructionsAccepted.diff(instructionsReceived)
            );
            if (difference > 60000 * 10) {
              // 10 minutes
              $(td).css("background-color", "rgba(255, 0, 0, 0.2)");
            }
          }
        },
      },
      {
        // Instructions Accepted
        target: [6],
        render: function (data, type, row, meta) {
          return data === null ? "- - - - - -" : moment(data).format("LT");
        },
        createdCell: function (td, cellData, rowData, row, col) {
          var instructionsReceived = moment(rowData.instructionsReceived);
          var instructionsAccepted = moment(rowData.instructionsAccepted);
          var departureTime = moment(rowData.departureTime);

          if (
            instructionsAccepted.isValid() &&
            instructionsReceived.isValid()
          ) {
            var difference = moment.duration(
              instructionsAccepted.diff(instructionsReceived)
            );
            if (difference > 60000 * 10) {
              // 10 minutes
              $(td).css("background-color", "rgba(255, 0, 0, 0.2)");
            }
          }

          if (instructionsAccepted.isValid() && departureTime.isValid()) {
            var difference = moment.duration(
              departureTime.diff(instructionsAccepted)
            );
            if (difference > 60000 * (20 + rowData.yardMoves * 7)) {
              // 20 minutes
              $(td).css("background-color", "rgba(255, 0, 0, 0.2)");
            }
          }
        },
      },
      {
        target: [7],
        render: function (data, type, row, meta) {
          return data === null ? "- - - - - -" : moment(data).format("LT");
        },
        createdCell: function (td, cellData, rowData, row, col) {
          var arrivalTime = moment(rowData.arrivalTime);
          var instructionsReceived = moment(rowData.instructionsReceived);
          var instructionsAccepted = moment(rowData.instructionsAccepted);
          var departureTime = moment(rowData.departureTime);

          if (instructionsAccepted.isValid() && departureTime.isValid()) {
            var difference = moment.duration(
              departureTime.diff(instructionsAccepted)
            );
            if (difference > 60000 * (20 + rowData.yardMoves * 5)) {
              // 20 minutes
              $(td).css("background-color", "rgba(255, 0, 0, 0.2)");
            }
          }

          if (
            arrivalTime.isValid() &&
            departureTime.isValid() &&
            !instructionsReceived.isValid() &&
            !instructionsAccepted.isValid()
          ) {
            var difference = moment.duration(departureTime.diff(arrivalTime));
            if (difference > 60000 * 30) {
              // 25 minutes
              $(td).css("background-color", "rgba(255, 0, 0, 0.2)");
            }
          }
        },
      },
    ],
    language: {
      emptyTable:
        "<em>Select a driver above in order to view their activity log history</em>",
    },
    order: [[0, "desc"]],
    drawCallback: function (data) {
      //initializePopovers2();
    },
  });

  var shipmentProductListTable = $("#shipmentProductListTable").DataTable({
    ajax: fileLocation + "../../../test/products.txt",
    autoWidth: false,
    responsive: true,
    paging: false,
    searching: false,
    info: false,
    pageLength: 25,
    scrollY: "38vh",
    language: {
      paginate: {
        next: "<i class='bi bi-arrow-right'></i>",
        previous: "<i class='bi bi-arrow-left'></i>",
      },
    },
    columns: [
      { data: "productCode", width: "15%" },
      { data: "description", width: "40%" },
      { data: "quantity", width: "15%" },
      { data: "batch", width: "15%" },
      { data: "expiration", width: "15%" },
    ],
    order: [[0, "asc"]],
  });

  const urlParams = new URLSearchParams(window.location.search);

  var driverPersonalActivityLogTable = $(
    "#driverPersonalActivityLogTable"
  ).DataTable({
    //ajax: fileLocation + "../../../src/requests/logs.php?action=get&id=" + urlParams.get("id"),
    ajax: fileLocation + "../../../test/logs.txt",
    autoWidth: false,
    responsive: true,
    pageLength: 25,
    scrollY: "35vh",
    columns: [
      /*{ data: "date", width: "8%" },
      { data: "facility", width: "10%" },
      { data: "arrivalTime", width: "10%" },
      { data: "instructionsReceived", width: "15%" },
      { data: "instructionsAccepted", width: "15%" },
      { data: "departureTime", width: "10%" },
      { data: "reason", width: "12%" },
      { data: "trailerId", width: "10%" },
      { data: "yardMoves", width: "10%" },*/

      {
        className: "dt-control",
        orderable: false,
        data: null,
        defaultContent: "",
        width: "3%",
      },
      { data: "date", width: "8%" },
      { data: "schedule", width: "12%" },
      { data: "clock-in", width: "10%" },
      { data: "clock-out", width: "10%" },
      { data: "shipments", width: "10%" },
      { data: "backhauls", width: "10%" },
      { data: "yard-moves", width: "10%" },
      { data: "stops", width: "10%" },
    ],
    columnDefs: [
      {
        targets: 0,
        createdCell: function (td, cellData, rowData, row, col) {
          $(td).attr("data-bs-toggle", "tooltip");
          $(td).attr("data-bs-placement", "top");
          $(td).attr("data-bs-html", "true");
          $(td).attr("title", "Toggle Daily Activity Log");
        },
      },
    ],
    language: {
      emptyTable: "<em>There is no activity log history for this driver.</em>",
    },
    order: [[1, "desc"]],
    drawCallback: function (data) {
      initializePopovers2();
    },
  });

  var driverPersonalFlaggedActivityLogTable = $(
    "#driverPersonalFlaggedActivityLogTable"
  ).DataTable({
    ajax:
      fileLocation +
      "../../../src/requests/logs.php?action=get-flagged&id=" +
      urlParams.get("id"),
    autoWidth: false,
    responsive: true,
    pageLength: 25,
    scrollY: "35vh",
    columns: [
      { data: "date", width: "8%" },
      { data: "facility", width: "10%" },
      { data: "arrivalTime", width: "10%" },
      { data: "instructionsReceived", width: "15%" },
      { data: "instructionsAccepted", width: "15%" },
      { data: "departureTime", width: "10%" },
      { data: "reason", width: "12%" },
      { data: "trailerId", width: "10%" },
      { data: "yardMoves", width: "10%" },
    ],
    columnDefs: [
      {
        targets: 0,
        createdCell: function (td, cellData, rowData, row, col) {
          $(td).attr("data-bs-toggle", "tooltip");
          $(td).attr("data-bs-placement", "top");
          $(td).attr("data-bs-html", "true");
          $(td).attr("title", "Toggle Daily Activity Log");
        },
      },
      {
        target: [0],
        render: function (data, type, row, meta) {
          return data === null ? "- - - - - -" : moment(data).format("L");
        },
      },
      {
        target: [2],
        render: function (data, type, row, meta) {
          return data === null ? "- - - - - -" : moment(data).format("LT");
        },
        createdCell: function (td, cellData, rowData, row, col) {
          var arrivalTime = moment(rowData.arrivalTime);
          var departureTime = moment(rowData.depatureTime);
          var instructionsReceived = moment(rowData.instructionsReceived);
          var instructionsAccepted = moment(rowData.instructionsAccepted);

          if (
            arrivalTime.isValid() &&
            departureTime.isValid() &&
            !instructionsReceived.isValid() &&
            !instructionsAccepted.isValid()
          ) {
            var difference = moment.duration(departureTime.diff(arrivalTime));
            if (difference > 60000 * 30) {
              // 30 minutes
              $(td).css("background-color", "rgba(255, 0, 0, 0.2)");
            }
          }
        },
      },
      {
        // Instructions Received
        target: [3],
        render: function (data, type, row, meta) {
          return data === null ? "- - - - - -" : moment(data).format("LT");
        },
        createdCell: function (td, cellData, rowData, row, col) {
          var instructionsReceived = moment(rowData.instructionsReceived);
          var instructionsAccepted = moment(rowData.instructionsAccepted);

          if (
            instructionsAccepted.isValid() &&
            instructionsReceived.isValid()
          ) {
            var difference = moment.duration(
              instructionsAccepted.diff(instructionsReceived)
            );
            if (difference > 60000 * 10) {
              // 10 minutes
              $(td).css("background-color", "rgba(255, 0, 0, 0.2)");
            }
          }
        },
      },
      {
        // Instructions Accepted
        target: [4],
        render: function (data, type, row, meta) {
          return data === null ? "- - - - - -" : moment(data).format("LT");
        },
        createdCell: function (td, cellData, rowData, row, col) {
          var instructionsReceived = moment(rowData.instructionsReceived);
          var instructionsAccepted = moment(rowData.instructionsAccepted);
          var departureTime = moment(rowData.departureTime);

          if (
            instructionsAccepted.isValid() &&
            instructionsReceived.isValid()
          ) {
            var difference = moment.duration(
              instructionsAccepted.diff(instructionsReceived)
            );
            if (difference > 60000 * 10) {
              // 10 minutes
              $(td).css("background-color", "rgba(255, 0, 0, 0.2)");
            }
          }

          if (instructionsAccepted.isValid() && departureTime.isValid()) {
            var difference = moment.duration(
              departureTime.diff(instructionsAccepted)
            );
            if (difference > 60000 * (20 + rowData.yardMoves * 7)) {
              // 20 minutes
              $(td).css("background-color", "rgba(255, 0, 0, 0.2)");
            }
          }
        },
      },
      {
        target: [5],
        render: function (data, type, row, meta) {
          return data === null ? "- - - - - -" : moment(data).format("LT");
        },
        createdCell: function (td, cellData, rowData, row, col) {
          var arrivalTime = moment(rowData.arrivalTime);
          var instructionsReceived = moment(rowData.instructionsReceived);
          var instructionsAccepted = moment(rowData.instructionsAccepted);
          var departureTime = moment(rowData.departureTime);

          if (instructionsAccepted.isValid() && departureTime.isValid()) {
            var difference = moment.duration(
              departureTime.diff(instructionsAccepted)
            );
            if (difference > 60000 * (20 + rowData.yardMoves * 5)) {
              // 20 minutes
              $(td).css("background-color", "rgba(255, 0, 0, 0.2)");
            }
          }

          if (
            arrivalTime.isValid() &&
            departureTime.isValid() &&
            !instructionsReceived.isValid() &&
            !instructionsAccepted.isValid()
          ) {
            var difference = moment.duration(departureTime.diff(arrivalTime));
            if (difference > 60000 * 30) {
              // 25 minutes
              $(td).css("background-color", "rgba(255, 0, 0, 0.2)");
            }
          }
        },
      },
    ],
    language: {
      emptyTable: "<em>There is no activity log history for this driver.</em>",
    },
    order: [[0, "desc"]],
    drawCallback: function (data) {
      initializePopovers2();
    },
  });

  var driverCompletedShipmentsTable = $(
    "#driverCompletedShipmentsTable"
  ).DataTable({
    ajax:
      fileLocation +
      "../../../src/requests/shipment.php?action=get-driver-shipments&id=" +
      urlParams.get("id"),
    autoWidth: false,
    responsive: true,
    pageLength: 25,
    scrollY: "35vh",
    language: {
      paginate: {
        next: "<i class='bi bi-arrow-right'></i>",
        previous: "<i class='bi bi-arrow-left'></i>",
      },
    },
    columns: [
      {
        className: "dt-control",
        orderable: false,
        data: null,
        defaultContent: "",
        width: "3%",
      },
      { data: "date", width: "6%" },
      { data: "time", width: "6%" },
      { data: "id", width: "9%" },
      { data: "orderNumber", width: "10%" },
      { data: "pallets", width: "6%" },
      { data: "netWeight", width: "8%" },
      { data: "grossWeight", width: "9%" },
      { data: "trailerId", width: "7%" },
      { data: "facility", width: "9%" },
      { data: "door", width: "9%" },
      { data: "images", width: "6%" },
    ],
    columnDefs: [
      {
        targets: 0,
        createdCell: function (td, cellData, rowData, row, col) {
          $(td).attr("data-bs-toggle", "tooltip");
          $(td).attr("data-bs-placement", "top");
          $(td).attr("data-bs-html", "true");
          $(td).attr("title", "Toggle Product Information");
        },
      },
    ],
    order: [[1, "desc"]],
  });

  var driverActivityLogTable = $("#driverActivityLogTable").DataTable({
    ajax: "",
    responsive: true,
    paging: false,
    searching: false,
    info: false,
    columns: [
      {
        className: "dt-control",
        orderable: false,
        data: null,
        defaultContent: "",
      },
      { data: "date" },
      { data: "schedule", className: "text-center" },
      { data: "clock-in", className: "text-center" },
      { data: "clock-out", className: "text-center" },
      { data: "shipments", className: "text-center" },
      { data: "backhauls", className: "text-center" },
      { data: "yard-moves", className: "text-center" },
      { data: "stops", className: "text-center" },
    ],
    columnDefs: [
      {
        targets: 0,
        createdCell: function (td, cellData, rowData, row, col) {
          $(td).attr("data-bs-toggle", "tooltip");
          $(td).attr("data-bs-placement", "top");
          $(td).attr("data-bs-html", "true");
          $(td).attr("title", "Toggle Daily Activity Log");
        },
      },
    ],
    language: {
      emptyTable:
        "<em>Select a driver above in order to view their activity log history</em>",
    },
    order: [[2, "asc"]],
    drawCallback: function (data) {
      initializePopovers2();
    },
  });

  var southernDoorsTable = $("#southernDoorsTable").DataTable({
    responsive: true,
    paging: false,
    searching: false,
    info: false,
    ordering: false,
    ajax: fileLocation + "../../src/requests/doors.php?action=southList",
    columns: [
      { data: "door" },
      { data: "carrier" },
      { data: "trailer" },
      { data: "status", className: "text-center" },
    ],
    drawCallback: function (data) {
      initializeTooltips();

      $('[data-toggle="popover-shipment"]').each(function () {
        var id = $(this).attr("data-index");
        $(this).popover({
          html: true,
          sanitize: false,
          trigger: "click",
          container: $(this).attr("data-facility")
            ? ".card-header-options-no-header"
            : "body",
          template:
            '<div class="popover popover-assign-' +
            id +
            '"><a href="" class="close-popover"><i class="bi bi-x" style="color: var(--mron-green); font-weight: bold; font-size: 1.7rem; position: absolute; top: 0; right: 10px;"></i></a><div class="popover-arrow"></div><h3 class="popover-header px-5"></h3><div class="popover-body"></div></div>',
          title: function () {
            return "Shipment Details";
          },
          content: function () {
            return $(
              "#assign-" + $(this).attr("data-type") + "-popover"
            ).html();
          },
        });
      });
    },
  });

  var northernDoorsTable = $("#northernDoorsTable").DataTable({
    responsive: true,
    paging: false,
    searching: false,
    info: false,
    ordering: false,
    ajax: fileLocation + "../../src/requests/doors.php?action=northList",
    columns: [
      { data: "door" },
      { data: "carrier" },
      { data: "trailer" },
      { data: "status", className: "text-center" },
    ],
    drawCallback: function (data) {
      initializeTooltips();
      $('[data-toggle="popover-shipment"]').each(function () {
        var id = $(this).attr("data-index");
        $(this).popover({
          html: true,
          sanitize: false,
          trigger: "click",
          container: $(this).attr("data-facility")
            ? ".card-header-options-no-header"
            : "body",
          template:
            '<div class="popover popover-assign-' +
            id +
            '"><a href="" class="close-popover"><i class="bi bi-x" style="color: var(--mron-green); font-weight: bold; font-size: 1.7rem; position: absolute; top: 0; right: 10px;"></i></a><div class="popover-arrow"></div><h3 class="popover-header px-5"></h3><div class="popover-body"></div></div>',
          title: function () {
            return "Shipment Details";
          },
          content: function () {
            return $(
              "#assign-" + $(this).attr("data-type") + "-popover"
            ).html();
          },
        });
      });
    },
  });

  var yardTable = $("#yardTable").DataTable({
    responsive: true,
    paging: false,
    searching: false,
    info: false,
    ordering: false,
    ajax: fileLocation + "../../src/requests/yard.php?action=trailerList",
    columns: [
      { data: "carrier", width: "45%" },
      { data: "trailer", width: "35%" },
      { data: "status", className: "text-center" },
    ],
    drawCallback: function (data) {
      $('[data-toggle="popover-shipment"]').each(function () {
        var id = $(this).attr("data-index");
        $(this).popover({
          html: true,
          sanitize: false,
          trigger: "click",
          container: $(this).attr("data-facility")
            ? ".card-header-options-no-header"
            : "body",
          template:
            '<div class="popover popover-assign-' +
            id +
            '"><a href="" class="close-popover"><i class="bi bi-x" style="color: var(--mron-green); font-weight: bold; font-size: 1.7rem; position: absolute; top: 0; right: 10px;"></i></a><div class="popover-arrow"></div><h3 class="popover-header px-5"></h3><div class="popover-body"></div></div>',
          title: function () {
            return "Shipment Details";
          },
          content: function () {
            return $(
              "#assign-" + $(this).attr("data-type") + "-popover"
            ).html();
          },
        });
      });
    },
  });

  var fileLocation = $("script[src*=script]")
    .attr("src")
    .replace(/script\.js.*$/, "");
  var allShipmentsTable = $("#allShipmentsTable").DataTable({
    ajax:
      fileLocation + "../../src/requests/shipment.php?action=get-shipments&query=ALL",
    responsive: true,
    pageLength: 25,
    scrollY: "55vh",
    language: {
      paginate: {
        next: "<i class='bi bi-arrow-right'></i>",
        previous: "<i class='bi bi-arrow-left'></i>",
      },
    },
    columns: [
      {
        className: "dt-control",
        orderable: false,
        data: null,
        defaultContent: "",
        width: "3%",
      },
      { data: "date", width: "7%" },
      { data: "time", width: "7%" },
      { data: "id", width: "9%" },
      { data: "orderNumber", width: "10%" },
      { data: "pallets", width: "6%" },
      { data: "netWeight", width: "8%" },
      { data: "grossWeight", width: "9%" },
      { data: "trailerId", width: "7%" },
      { data: "driver", width: "12%" },
      { data: "facility", width: "10%" },
      { data: "images", width: "5%" },
      { data: "status", width: "6%" },
    ],
    columnDefs: [
      {
        targets: 0,
        createdCell: function (td, cellData, rowData, row, col) {
          $(td).attr("data-bs-toggle", "tooltip");
          $(td).attr("data-bs-placement", "top");
          $(td).attr("data-bs-html", "true");
          $(td).attr("title", "Toggle Product Information");
        },
      },
    ],
    order: [[1, "asc"]],
  });

  var completedShipmentsTable = $("#completedShipmentsTable").DataTable({
    ajax: fileLocation + "../../src/requests/shipment.php?action=get-shipments&query=5",
    autoWidth: false,
    responsive: true,
    pageLength: 25,
    scrollY: "55vh",
    language: {
      paginate: {
        next: "<i class='bi bi-arrow-right'></i>",
        previous: "<i class='bi bi-arrow-left'></i>",
      },
    },
    columns: [
      {
        className: "dt-control",
        orderable: false,
        data: null,
        defaultContent: "",
        width: "3%",
      },
      { data: "date", width: "6%" },
      { data: "time", width: "6%" },
      { data: "id", width: "9%" },
      { data: "orderNumber", width: "10%" },
      { data: "pallets", width: "6%" },
      { data: "netWeight", width: "8%" },
      { data: "grossWeight", width: "9%" },
      { data: "trailerId", width: "7%" },
      { data: "driver", width: "11%" },
      { data: "facility", width: "9%" },
      { data: "door", width: "9%" },
      { data: "images", width: "6%" },
    ],
    columnDefs: [
      {
        targets: 0,
        createdCell: function (td, cellData, rowData, row, col) {
          $(td).attr("data-bs-toggle", "tooltip");
          $(td).attr("data-bs-placement", "top");
          $(td).attr("data-bs-html", "true");
          $(td).attr("title", "Toggle Product Information");
        },
      },
    ],
    order: [[1, "asc"]],
  });

  var forfeitedShipmentsTable = $("#forfeitedShipmentsTable").DataTable({
    ajax: fileLocation + "../../src/requests/shipment.php?action=get-shipments&query=6",
    autoWidth: false,
    responsive: true,
    pageLength: 25,
    scrollY: "55vh",
    language: {
      paginate: {
        next: "<i class='bi bi-arrow-right'></i>",
        previous: "<i class='bi bi-arrow-left'></i>",
      },
    },
    columns: [
      {
        className: "dt-control",
        orderable: false,
        data: null,
        defaultContent: "",
        width: "3%",
      },
      { data: "date", width: "7%" },
      { data: "time", width: "7%" },
      { data: "id", width: "9%" },
      { data: "orderNumber", width: "10%" },
      { data: "pallets", width: "6%" },
      { data: "netWeight", width: "8%" },
      { data: "grossWeight", width: "9%" },
      { data: "trailerId", width: "7%" },
      { data: "driver", width: "12%" },
      { data: "facility", width: "10%" },
      { data: "images", width: "6%" },
      { data: "assign", width: "5%" },
    ],
    columnDefs: [
      {
        targets: 0,
        createdCell: function (td, cellData, rowData, row, col) {
          $(td).attr("data-bs-toggle", "tooltip");
          $(td).attr("data-bs-placement", "top");
          $(td).attr("data-bs-html", "true");
          $(td).attr("title", "Toggle Product Information");
        },
      },
    ],
    order: [[1, "asc"]],
  });

  var awaitingShipmentTable = $("#awaitingShipmentTable").DataTable({
    ajax: fileLocation + "../../src/requests/shipment.php?action=get-shipments&query=3",
    autoWidth: false,
    responsive: true,
    pageLength: 25,
    scrollY: "55vh",
    language: {
      paginate: {
        next: "<i class='bi bi-arrow-right'></i>",
        previous: "<i class='bi bi-arrow-left'></i>",
      },
    },
    columns: [
      {
        className: "dt-control",
        orderable: false,
        data: null,
        defaultContent: "",
        width: "3%",
      },
      { data: "date", width: "7%" },
      { data: "time", width: "7%" },
      { data: "id", width: "9%" },
      { data: "orderNumber", width: "10%" },
      { data: "pallets", width: "6%" },
      { data: "netWeight", width: "8%" },
      { data: "grossWeight", width: "9%" },
      { data: "trailerId", width: "7%" },
      { data: "driver", width: "12%" },
      { data: "facility", width: "10%" },
    ],
    columnDefs: [
      {
        targets: 0,
        createdCell: function (td, cellData, rowData, row, col) {
          $(td).attr("data-bs-toggle", "tooltip");
          $(td).attr("data-bs-placement", "top");
          $(td).attr("data-bs-html", "true");
          $(td).attr("title", "Toggle Product Information");
        },
      },
    ],
    order: [[1, "asc"]],
  });

  var inTransitInboundShipmentsTable = $(
    "#inTransitInboundShipmentsTable"
  ).DataTable({
    ajax:
      fileLocation +
      "../../src/requests/shipment.php?action=get-inbound-shipments&query=1",
    autoWidth: false,
    responsive: true,
    pageLength: 25,
    scrollY: "55vh",
    language: {
      paginate: {
        next: "<i class='bi bi-arrow-right'></i>",
        previous: "<i class='bi bi-arrow-left'></i>",
      },
    },
    columns: [
      {
        className: "dt-control",
        orderable: false,
        data: null,
        defaultContent: "",
        width: "3%",
      },
      { data: "date" },
      { data: "time" },
      { data: "reference" },
      { data: "orderNumber" },
      { data: "pallets" },
      { data: "netWeight" },
      { data: "grossWeight" },
      { data: "trailerId" },
      { data: "driver" },
      { data: "carrier" },
      { data: "images" },

      /*{ data: "date", width: "8%" },
      { data: "time", width: "8%" },
      { data: "reference", width: "9%" },
      { data: "orderNumber", width: "10%" },
      { data: "pallets", width: "8%" },
      { data: "netWeight", width: "8%" },
      { data: "grossWeight", width: "9%" },
      { data: "trailerId", width: "7%" },
      { data: "driver", width: "12%" },
      { data: "carrier", width: "8%" },
      { data: "images", width: "8%" },*/
    ],
    columnDefs: [
      {
        targets: 0,
        createdCell: function (td, cellData, rowData, row, col) {
          $(td).attr("data-bs-toggle", "tooltip");
          $(td).attr("data-bs-placement", "top");
          $(td).attr("data-bs-html", "true");
          $(td).attr("title", "Toggle Product Information");
        },
      },
    ],
    order: [[1, "asc"]],
  });

  var receivedInboundShipmentsTable = $(
    "#receivedInboundShipmentsTable"
  ).DataTable({
    ajax:
      fileLocation +
      "../../src/requests/shipment.php?action=get-inbound-shipments&query=2",
    autoWidth: false,
    responsive: true,
    pageLength: 25,
    scrollY: "55vh",
    language: {
      paginate: {
        next: "<i class='bi bi-arrow-right'></i>",
        previous: "<i class='bi bi-arrow-left'></i>",
      },
    },
    columns: [
      {
        className: "dt-control",
        orderable: false,
        data: null,
        defaultContent: "",
        width: "3%",
      },
      { data: "date", width: "8%" },
      { data: "time", width: "8%" },
      { data: "reference", width: "9%" },
      { data: "orderNumber", width: "10%" },
      { data: "pallets", width: "8%" },
      { data: "netWeight", width: "8%" },
      { data: "grossWeight", width: "9%" },
      { data: "trailerId", width: "7%" },
      { data: "driver", width: "12%" },
      { data: "carrier", width: "12%" },
      { data: "images", width: "8%" },
    ],
    columnDefs: [
      {
        targets: 0,
        createdCell: function (td, cellData, rowData, row, col) {
          $(td).attr("data-bs-toggle", "tooltip");
          $(td).attr("data-bs-placement", "top");
          $(td).attr("data-bs-html", "true");
          $(td).attr("title", "Toggle Product Information");
        },
      },
    ],
    order: [[1, "asc"]],
  });

  var claimableShipmentsTable = $("#claimableShipmentsTable").DataTable({
    ajax: fileLocation + "../../src/requests/shipment.php?action=get-shipments&query=6",
    responsive: true,
    paging: false,
    searching: false,
    info: false,
    ordering: false,
    columns: [
      { data: "date" },
      { data: "id" },
      { data: "trailer" },
      { data: "action" },
    ],
    order: [[0, "asc"]],
  });

  // Warehouses
  var inboundShipmentsTable = $("#inboundShipmentsTable").DataTable({
    responsive: true,
    pageLength: 10,
    language: {
      paginate: {
        next: "<i class='bi bi-arrow-right'></i>",
        previous: "<i class='bi bi-arrow-left'></i>",
      },
    },
    columnDefs: [
      {
        targets: 0,
        className: "dt-control",
        orderable: false,
        data: null,
        defaultContent: "",
        createdCell: function (td, cellData, rowData, row, col) {
          $(td).attr("data-bs-toggle", "tooltip");
          $(td).attr("data-bs-placement", "top");
          $(td).attr("data-bs-html", "true");
          $(td).attr("title", "Toggle Product Information");
        },
      },
    ],
    language: {
      emptyTable: "<em>There are currently no inbound shipments</em>",
    },
    drawCallback: function (data) {
      initializePopovers();
    },
  });
  var receivedShipmentsTableV = $("#receivedShipmentsTableV").DataTable({
    responsive: true,
    pageLength: 10,
    language: {
      paginate: {
        next: "<i class='bi bi-arrow-right'></i>",
        previous: "<i class='bi bi-arrow-left'></i>",
      },
    },
    columnDefs: [
      {
        targets: 0,
        className: "dt-control",
        orderable: false,
        data: null,
        defaultContent: "",
        createdCell: function (td, cellData, rowData, row, col) {
          $(td).attr("data-bs-toggle", "tooltip");
          $(td).attr("data-bs-placement", "top");
          $(td).attr("data-bs-html", "true");
          $(td).attr("title", "Toggle Product Information");
        },
      },
    ],
    language: {
      emptyTable: "<em>There are no received shipments available</em>",
    },
  });

  $("#activeDriverTable tbody").on("click", "td.dt-control", function () {
    var tr = $(this).closest("tr");
    var row = activeDriverTable.row(tr);

    if (row.child.isShown()) {
      row.child.hide();
      tr.removeClass("shown");
    } else {
      row.child(format2(row.data())).show();
      tr.addClass("shown");
    }
  });

  $("#driverActivityLogTable tbody").on("click", "td.dt-control", function () {
    var tr = $(this).closest("tr");
    var row = driverActivityLogTable.row(tr);

    if (row.child.isShown()) {
      row.child.hide();
      tr.removeClass("shown");
    } else {
      row.child(format2(row.data())).show();
      tr.addClass("shown");
    }
  });

  $("#driverPersonalActivityLogTable tbody").on(
    "click",
    "td.dt-control",
    function () {
      var tr = $(this).closest("tr");
      var row = driverPersonalActivityLogTable.row(tr);

      if (row.child.isShown()) {
        row.child.hide();
        tr.removeClass("shown");
      } else {
        row.child(format2(row.data())).show();
        tr.addClass("shown");
      }
    }
  );

  $("#allShipmentsTable tbody").on("click", "td.dt-control", function () {
    var tr = $(this).closest("tr");
    var row = allShipmentsTable.row(tr);

    if (row.child.isShown()) {
      row.child.hide();
      tr.removeClass("shown");
    } else {
      row.child(format(row.data())).show();
      tr.addClass("shown");
    }
  });

  $("#inTransitInboundShipmentsTable tbody").on("click", "td.dt-control", function () {
    var tr = $(this).closest("tr");
    var row = inTransitInboundShipmentsTable.row(tr);

    if (row.child.isShown()) {
      row.child.hide();
      tr.removeClass("shown");
    } else {
      row.child(format(row.data())).show();
      tr.addClass("shown");
    }
  });

  $("#receivedInboundShipmentsTable tbody").on("click", "td.dt-control", function () {
    var tr = $(this).closest("tr");
    var row = receivedInboundShipmentsTable.row(tr);

    if (row.child.isShown()) {
      row.child.hide();
      tr.removeClass("shown");
    } else {
      row.child(format(row.data())).show();
      tr.addClass("shown");
    }
  });

  $("#forfeitedShipmentsTable tbody").on("click", "td.dt-control", function () {
    var tr = $(this).closest("tr");
    var row = forfeitedShipmentsTable.row(tr);

    if (row.child.isShown()) {
      row.child.hide();
      tr.removeClass("shown");
    } else {
      row.child(format(row.data())).show();
      tr.addClass("shown");
    }
  });

  $("#awaitingShipmentTable tbody").on("click", "td.dt-control", function () {
    var tr = $(this).closest("tr");
    var row = awaitingShipmentTable.row(tr);

    if (row.child.isShown()) {
      row.child.hide();
      tr.removeClass("shown");
    } else {
      row.child(format(row.data())).show();
      tr.addClass("shown");
    }
  });

  $("#completedShipmentsTable tbody").on("click", "td.dt-control", function () {
    var tr = $(this).closest("tr");
    var row = completedShipmentsTable.row(tr);

    if (row.child.isShown()) {
      row.child.hide();
      tr.removeClass("shown");
    } else {
      row.child(format(row.data())).show();
      tr.addClass("shown");
    }
  });

  $("#inboundShipmentsTable tbody").on("click", "td.dt-control", function () {
    var tr = $(this).closest("tr");
    var row = inboundShipmentsTable.row(tr);

    if (row.child.isShown()) {
      row.child.hide();
      tr.removeClass("shown");
    } else {
      row.child(format(row.data())).show();
      tr.addClass("shown");
    }
  });

  $("#receivedShipmentsTable tbody").on("click", "td.dt-control", function () {
    var tr = $(this).closest("tr");
    var row = receivedShipmentsTable.row(tr);

    if (row.child.isShown()) {
      row.child.hide();
      tr.removeClass("shown");
    } else {
      row.child(format(row.data())).show();
      tr.addClass("shown");
    }
  });
});
